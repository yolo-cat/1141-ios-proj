# Supabase 開發指南（Stage 1）

## 核心目標
- 依 `stage_1_prd.md` 建立 `readings` 資料表：
  - `id int8 generated by default as identity primary key`
  - `created_at timestamptz not null default now()`
  - `device_id text not null`
  - `temperature float4 not null`
  - `humidity float4 not null`
- 啟用 RLS，策略：
  - INSERT：允許 `anon` 寫入（給 ESP32 使用）
  - SELECT：僅 `authenticated` 可讀取

## 產出與存放
- SQL / migration 檔案存放於 `supabase/` 目錄。
- 開發步驟文檔需同步更新（使用 `supabase/README.md`），說明如何套用 schema 與策略。

## 作業原則
- 一切以 PRD（`stage_1_prd.md`）與根目錄 `AGENTS.md` 為準，不自行變更欄位型別（溫濕度皆用 `float4`）。
- 透過 Supabase SQL Editor 或 CLI 執行，命令需可重複（idempotent，重複執行不應造成重複資源或副作用）。
- REST 端點預期為 `https://<PROJECT_REF>.supabase.co/rest/v1/readings`，HTTP 標頭需包含 `apikey` 與 `Authorization: Bearer <SUPABASE_ANON_KEY>`。
